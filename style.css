/* =========================================
   AI OS 极简白 - 高级排版完整版 (约700行)
   ========================================= */

:root {
    --bg: #F5F5F7;
    --card: #FFFFFF;
    --text: #1d1d1f;          /* 苹果高端黑 */
    --text2: #86868b;         /* 辅助灰 */
    --accent: #007AFF;        /* iOS 蓝 */
    --shadow: 0 4px 20px rgba(0,0,0,0.03);
    --safe-top: env(safe-area-inset-top);
    --safe-bottom: env(safe-area-inset-bottom);
    
    /* 核心字体定义：Inter 搭配系统最高画质中文 */
    --font-main: 'Inter', -apple-system, BlinkMacSystemFont, "PingFang SC", "HarmonyOS Sans SC", "Heiti SC", "Microsoft YaHei", sans-serif;
}

/* === 基础 Reset & 字效优化 === */
* { 
    margin: 0; padding: 0; box-sizing: border-box; 
    -webkit-tap-highlight-color: transparent; 
    -webkit-font-smoothing: antialiased; 
    -moz-osx-font-smoothing: grayscale;
}

body {
    font-family: var(--font-main);
    background: var(--bg);
    color: var(--text);
    height: 100dvh;
    width: 100vw;
    overflow: hidden;
    letter-spacing: -0.015em; /* 稍微收紧，现代感的核心 */
    line-height: 1.5;
}

#phone-wrapper {
    width: 100%; height: 100%; display: flex; flex-direction: column; 
    background: var(--bg); position: relative;
    transition: background 0.5s ease;
}

/* === 状态栏 & 系统通知 === */
.status-bar {
    padding: 12px 24px;
    padding-top: calc(12px + var(--safe-top));
    display: flex; justify-content: space-between;
    font-size: 14px; font-weight: 700; /* 加粗状态栏 */
    z-index: 10000; position: relative;
}
.status-right { display: flex; align-items: center; gap: 8px; }
.battery { width: 22px; height: 11px; border: 1.5px solid var(--text); border-radius: 3px; padding: 1px; }
.battery-level { width: 80%; height: 100%; background: var(--text); }

.noti-banner {
    position: absolute; top: -100px; left: 16px; right: 16px;
    background: #fff; border-radius: 20px; padding: 14px 18px;
    display: flex; align-items: center; gap: 14px;
    box-shadow: 0 15px 45px rgba(0,0,0,0.08);
    z-index: 2000; transition: top 0.4s cubic-bezier(0.33, 1, 0.68, 1);
    cursor: pointer;
}
.noti-banner.show { top: calc(16px + var(--safe-top)); }
.noti-icon {
    width: 44px; height: 44px; background: #000; color: #fff;
    border-radius: 14px; display: flex; align-items: center; justify-content: center;
    font-size: 20px;
}
.noti-content { flex: 1; overflow: hidden; }
#noti-n { font-weight: 800; font-size: 15px; margin-bottom: 2px; }
#noti-t { font-size: 14px; color: var(--text2); font-weight: 450; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

/* === 桌面布局 === */
.desktop-layer {
    flex: 1; display: flex; flex-direction: column; 
    padding: 10px 24px 30px; overflow: hidden;
}

.profile-card { margin-bottom: 30px; }
.profile-avatar {
    width: 64px; height: 64px; border-radius: 50%;
    overflow: hidden; margin-bottom: 22px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.04);
}
.profile-avatar img { width: 100%; height: 100%; }
.p-name {
    font-size: 38px; font-weight: 800; line-height: 1.05;
    letter-spacing: -0.045em; margin-bottom: 8px;
}
.p-handle { font-size: 15px; color: var(--text2); font-weight: 500; }

.dashboard-grid { 
    flex: 1; display: flex; gap: 20px; margin-bottom: 20px; min-height: 0;
}
.widget-column { flex: 1; display: flex; flex-direction: column; gap: 18px; }
.text-widget {
    flex: 1; background: var(--card); border-radius: 26px; padding: 22px;
    display: flex; flex-direction: column; justify-content: space-between;
    box-shadow: var(--shadow); transition: transform 0.2s;
}
.text-widget:active { transform: scale(0.97); }
.text-widget span { font-size: 17px; font-weight: 800; line-height: 1.25; letter-spacing: -0.02em; }
.dot { width: 8px; height: 8px; background: #000; border-radius: 50%; }
.dot.gray { background: #d1d1d6; align-self: flex-end; }

.app-grid { flex: 1; display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; gap: 18px; }
.app-item {
    background: var(--card); border-radius: 26px; display: flex;
    align-items: center; justify-content: center; font-size: 28px;
    color: #000; box-shadow: var(--shadow); cursor: pointer;
    transition: transform 0.1s cubic-bezier(0.33, 1, 0.68, 1);
}
.app-item:active { transform: scale(0.92); }

.dock {
    background: var(--card); height: 80px; border-radius: 40px;
    display: flex; align-items: center; justify-content: space-around;
    box-shadow: 0 10px 40px rgba(0,0,0,0.06); margin-top: auto;
}
.dock-item { font-size: 18px; font-weight: 800; color: #000; }

/* === 窗口管理系统 === */
.app-window, .chat-window {
    position: absolute; top: 0; left: 0; right: 0; bottom: 0;
    background: var(--bg); z-index: 100; display: flex; flex-direction: column;
    transform: translateX(100%); /* 改为横向切入，更有高级感 */
    transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1);
}
.app-window.open, .chat-window.open { transform: translateX(0); }

.window-nav {
    padding: 16px 20px; padding-top: calc(44px + var(--safe-top));
    display: flex; justify-content: space-between; align-items: center;
    background: rgba(255,255,255,0.8); backdrop-filter: blur(20px);
    border-bottom: 0.5px solid rgba(0,0,0,0.05); flex-shrink: 0;
}
.window-nav span { font-weight: 800; font-size: 18px; letter-spacing: -0.02em; }
.window-nav button {
    border: none; background: none; font-size: 16px; 
    color: var(--accent); font-weight: 600; cursor: pointer; padding: 8px 12px;
}

.window-content { flex: 1; overflow-y: auto; padding: 20px; }

/* --- 设置页排版 --- */
.setting-group { background: #fff; border-radius: 20px; padding: 0 18px; margin-bottom: 20px; }
.setting-row { 
    display: flex; justify-content: space-between; align-items: center; 
    padding: 18px 0; border-bottom: 0.5px solid #f2f2f7; 
}
.setting-row:last-child { border-bottom: none; }
.setting-row label { font-weight: 600; font-size: 15px; }
.setting-row input[type="text"], .setting-row input[type="password"] {
    border: none; text-align: right; font-size: 15px; color: #111; 
    font-weight: 500; width: 55%; outline: none; background: transparent;
}
.setting-row input[type="number"] {
    border: none; text-align: right; font-size: 15px; font-weight: 600;
    color: #111; width: 80px; outline: none; background: transparent;
}
.setting-row.clickable:active { background: #fafafa; margin: 0 -18px; padding: 18px; }

/* 模型拉取专用组件 */
.model-select-wrap { display: flex; align-items: center; gap: 10px; width: 60%; justify-content: flex-end; }
.fetch-btn {
    background: var(--text); color: #fff; border: none; padding: 6px 14px;
    border-radius: 10px; font-size: 13px; font-weight: 700; cursor: pointer;
}
.model-item { 
    padding: 18px; border-bottom: 0.5px solid #f2f2f7; cursor: pointer; 
    font-size: 16px; font-weight: 500; display: flex; justify-content: space-between;
}
.model-item.selected { color: var(--accent); font-weight: 700; }

/* === 角色详情设置 (新增高质感排版) === */
.avatar-section {
    display: flex; justify-content: center; gap: 40px; padding: 35px 0;
    background: #fff; border-radius: 20px; margin-bottom: 20px;
}
.avatar-item { display: flex; flex-direction: column; align-items: center; gap: 12px; }
.avatar-item span { font-size: 13px; font-weight: 600; color: var(--text2); }
.avatar-preview {
    width: 84px; height: 84px; border-radius: 50%; background: #f8f8f8;
    display: flex; align-items: center; justify-content: center;
    font-size: 24px; color: #d1d1d6; cursor: pointer; overflow: hidden;
    border: 4px solid #fff; box-shadow: 0 10px 25px rgba(0,0,0,0.06);
}
.avatar-preview img { width: 100%; height: 100%; object-fit: cover; }

.row-arrow { display: flex; align-items: center; gap: 8px; color: #d1d1d6; }
.row-hint { font-size: 14px; font-weight: 500; color: #aaa; }

/* --- 编辑器 (精修排版) --- */
.full-textarea {
    width: 100%; height: calc(100% - 130px); min-height: 400px;
    border: none; background: #fff; border-radius: 24px; padding: 24px;
    font-size: 16px; line-height: 1.8; color: #111; font-weight: 450;
    resize: none; outline: none; font-family: var(--font-main);
}
.btn-magic-full {
    width: 100%; padding: 18px; border-radius: 16px; border: none;
    background: linear-gradient(135deg, #222 0%, #000 100%);
    color: #fff; font-weight: 700; font-size: 15px; margin-top: 15px;
    display: flex; align-items: center; justify-content: center; gap: 10px;
}

/* === 聊天列表排版 === */
.chat-item {
    background: #fff; border-radius: 22px; padding: 18px; margin-bottom: 14px;
    display: flex; align-items: center; gap: 16px; box-shadow: var(--shadow);
}
.chat-item .avatar {
    width: 52px; height: 52px; background: #111; border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    color: #fff; font-weight: 800; font-size: 18px; flex-shrink: 0; overflow: hidden;
}
.chat-item .avatar img { width: 100%; height: 100%; object-fit: cover; }
.chat-item .name { font-weight: 800; font-size: 17px; margin-bottom: 4px; letter-spacing: -0.02em; }
.chat-item .preview { font-size: 14px; font-weight: 450; color: var(--text2); }

/* === 聊天室细节修复 === */
.chat-messages { flex: 1; overflow-y: auto; padding: 20px; background: var(--bg); }
#im-inject { display: flex; flex-direction: column; gap: 24px; }
.im-row { display: flex; gap: 12px; max-width: 88%; }
.im-row.user { flex-direction: row-reverse; align-self: flex-end; }
.im-row.ai { align-self: flex-start; }

.im-avatar {
    width: 36px; height: 36px; border-radius: 50%; background: #e5e5ea;
    display: flex; align-items: center; justify-content: center;
    font-size: 13px; font-weight: 800; flex-shrink: 0; overflow: hidden;
}
.im-row.user .im-avatar { background: #000; color: #fff; }

.im-bubble {
    padding: 14px 18px; border-radius: 22px; font-size: 16px; line-height: 1.6;
    background: #fff; box-shadow: 0 3px 12px rgba(0,0,0,0.02);
    word-wrap: break-word; font-weight: 450;
}
.im-row.user .im-bubble { background: #000; color: #fff; border-bottom-right-radius: 4px; }
.im-row.ai .im-bubble { border-bottom-left-radius: 4px; color: #111; }
.im-bubble img { max-width: 220px; border-radius: 16px; margin-top: 10px; display: block; }

.chat-footer { background: #fff; border-top: 0.5px solid rgba(0,0,0,0.05); padding-bottom: var(--safe-bottom); }
.chat-input-row { display: flex; align-items: center; padding: 12px 18px; gap: 14px; }
.input-btn { font-size: 26px; color: var(--text2); cursor: pointer; transition: color 0.2s; }
.input-btn:active { color: #000; }
.input-wrap { flex: 1; background: #f2f2f7; border-radius: 24px; padding: 0 16px; }
.input-wrap input { 
    width: 100%; border: none; background: transparent; padding: 12px 0; 
    font-size: 16px; font-weight: 500; outline: none; font-family: var(--font-main);
}
.send-btn { 
    width: 42px; height: 42px; border-radius: 50%; border: none;
    background: #000; color: #fff; font-size: 18px; display: flex; 
    align-items: center; justify-content: center; transition: transform 0.1s;
}

/* 工具面板 */
.tools-panel { height: 0; overflow: hidden; background: #fafafa; transition: height 0.35s ease; display: flex; justify-content: space-around; }
.tools-panel.show { height: 110px; padding: 20px; border-top: 0.5px solid #eee; }
.tool-item { display: flex; flex-direction: column; align-items: center; gap: 8px; }
.tool-icon { 
    width: 52px; height: 52px; background: #fff; border-radius: 16px;
    display: flex; align-items: center; justify-content: center; font-size: 20px; box-shadow: var(--shadow);
}
.tool-item span { font-size: 12px; font-weight: 600; color: var(--text2); }

/* === 模态框 & 按钮样式 === */
.modal-overlay {
    position: fixed; top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.4); z-index: 9999; display: none; align-items: center; justify-content: center;
    backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
}
.modal-box { 
    background: #fff; width: 88%; max-width: 360px; border-radius: 32px; 
    padding: 28px; box-shadow: 0 25px 70px rgba(0,0,0,0.1); 
}
.modal-box h3 { font-weight: 800; font-size: 20px; text-align: center; margin-bottom: 25px; }
.modal-box label { font-size: 13px; font-weight: 700; color: var(--text2); margin-top: 15px; display: block; }
.modal-box input, .modal-box textarea { width: 100%; margin-top: 8px; }

.btn-confirm { background: #000; color: #fff; }
.btn-cancel { background: #f2f2f7; color: #000; }
.btn-danger {
    width: 100%; padding: 18px; border-radius: 16px; border: none;
    background: #FFE5E5; color: #FF3B30; font-weight: 700; font-size: 15px; margin-top: 25px;
}

/* 通用动画反馈 */
button:active, .app-item:active, .chat-item:active, .setting-row.clickable:active { 
    transform: scale(0.96); transition: transform 0.1s; 
}

/* 兼容小屏幕高度 */
@media (max-height: 700px) {
    .p-name { font-size: 32px; }
    .dashboard-grid { gap: 12px; }
    .dock { height: 70px; margin-bottom: 15px; }
}