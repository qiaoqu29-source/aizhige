/* =========================================
   AI OS 极简白 - 终极无损版 (约700行)
   ========================================= */

:root {
    --bg: #F5F5F7;
    --card: #FFFFFF;
    --text: #1d1d1f;
    --text2: #86868b;
    --accent: #007AFF;
    --shadow: 0 4px 20px rgba(0,0,0,0.03);
    --safe-top: env(safe-area-inset-top);
    --safe-bottom: env(safe-area-inset-bottom);
    --font-main: 'Inter', system-ui, -apple-system, sans-serif;
}

* { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; -webkit-font-smoothing: antialiased; }

body {
    font-family: var(--font-main); background: var(--bg); color: var(--text);
    height: 100dvh; width: 100vw; overflow: hidden; letter-spacing: -0.015em;
}

#phone-wrapper {
    width: 100%; height: 100%; display: flex; flex-direction: column; 
    background-size: cover; background-position: center; transition: background 0.5s;
}

/* 状态栏：层级最高且避让 */
.status-bar {
    padding: 12px 24px; padding-top: calc(12px + var(--safe-top));
    display: flex; justify-content: space-between; font-size: 14px; font-weight: 700;
    z-index: 10000; position: relative; color: inherit;
}
.battery { width: 22px; height: 11px; border: 1.5px solid currentColor; border-radius: 3px; padding: 1px; }
.battery-level { width: 80%; height: 100%; background: currentColor; }

/* 桌面 Profile: 居中放大 */
.profile-card.centered {
    display: flex; flex-direction: column; align-items: center; text-align: center;
    padding: 40px 24px 15px; margin-top: 10px;
}
.profile-avatar.large {
    width: 110px; height: 110px; border-radius: 50%; border: 4px solid #fff;
    box-shadow: 0 12px 35px rgba(0,0,0,0.08); margin-bottom: 20px; overflow: hidden;
}
.profile-avatar img { width: 100%; height: 100%; object-fit: cover; }
.p-name { font-size: 34px; font-weight: 800; line-height: 1.1; letter-spacing: -0.04em; }
.p-handle { font-size: 15px; color: var(--text2); margin-top: 6px; }

/* 桌面网格 */
.dashboard-grid { padding: 0 24px; display: flex; gap: 20px; flex: 1; }
.widget-column { flex: 1; display: flex; flex-direction: column; gap: 18px; }
.text-widget {
    background: var(--card); border-radius: 26px; padding: 20px;
    display: flex; flex-direction: column; justify-content: space-between;
    box-shadow: var(--shadow); height: 130px;
}
.text-widget span { font-size: 17px; font-weight: 800; }

.app-grid { flex: 1.3; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; align-content: flex-start; }
.app-item { display: flex; flex-direction: column; align-items: center; gap: 8px; cursor: pointer; }
.app-icon {
    width: 66px; height: 62px; border-radius: 20px; background: var(--card);
    display: flex; align-items: center; justify-content: center;
    box-shadow: var(--shadow); overflow: hidden; font-size: 28px;
}
.app-icon img { width: 100%; height: 100%; object-fit: cover; }
.app-name-label { font-size: 11.5px; font-weight: 700; color: var(--text); }

/* 窗口系统架构 */
.app-window, .chat-window {
    position: absolute; top: 0; left: 0; right: 0; bottom: 0;
    background: var(--bg); z-index: 1000; transform: translateX(100%);
    transition: transform 0.45s cubic-bezier(0.32, 0.72, 0, 1); display: flex; flex-direction: column;
}
.app-window.open, .chat-window.open { transform: translateX(0); }

/* 导航栏避让修复版 */
.window-nav {
    padding: 12px 20px; padding-top: calc(45px + var(--safe-top));
    display: flex; justify-content: space-between; align-items: center;
    background: rgba(255,255,255,0.85); backdrop-filter: blur(25px);
    border-bottom: 0.5px solid rgba(0,0,0,0.05); flex-shrink: 0;
}
.window-nav span { font-weight: 800; font-size: 17.5px; }
.window-nav button { border: none; background: none; color: var(--accent); font-weight: 600; font-size: 16px; cursor: pointer; }

/* 内容区域 */
.window-content { flex: 1; overflow-y: auto; padding: 20px; }
.setting-group { background: #fff; border-radius: 22px; padding: 0 18px; margin-bottom: 20px; }
.setting-row { display: flex; justify-content: space-between; align-items: center; padding: 18px 0; border-bottom: 0.5px solid #f2f2f7; }
.setting-row:last-child { border-bottom: none; }
.setting-row label { font-weight: 600; font-size: 15px; }
.setting-row input { border: none; text-align: right; background: transparent; width: 60%; font-size: 15px; outline: none; }
.setting-row.clickable:active { background: #fafafa; }

/* 聊天气泡 */
.chat-messages { flex: 1; overflow-y: auto; padding: 20px; background: var(--bg); }
#im-inject { display: flex; flex-direction: column; gap: 22px; }
.im-row { display: flex; gap: 12px; max-width: 88%; }
.im-row.user { flex-direction: row-reverse; align-self: flex-end; }
.im-avatar { width: 36px; height: 36px; border-radius: 50%; background: #eee; flex-shrink: 0; overflow: hidden; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 13px; }
.im-avatar img { width: 100%; height: 100%; object-fit: cover; }
.im-bubble { padding: 14px 18px; border-radius: 22px; font-size: 16px; line-height: 1.6; background: #fff; box-shadow: var(--shadow); word-wrap: break-word; }
.im-row.user .im-bubble { background: #000; color: #fff; border-bottom-right-radius: 4px; }
.im-row.ai .im-bubble { color: #111; border-bottom-left-radius: 4px; }

/* 详情编辑页特供 */
.avatar-section { display: flex; justify-content: center; gap: 40px; padding: 30px 0; background: #fff; border-radius: 22px; margin-bottom: 20px; }
.avatar-item { display: flex; flex-direction: column; align-items: center; gap: 10px; font-size: 13px; font-weight: 600; color: var(--text2); }
.avatar-preview { width: 84px; height: 84px; border-radius: 50%; background: #f8f8f8; display: flex; align-items: center; justify-content: center; overflow: hidden; border: 4px solid #fff; box-shadow: 0 8px 25px rgba(0,0,0,0.05); }
.avatar-preview img { width: 100%; height: 100%; object-fit: cover; }

.full-textarea { width: 100%; height: calc(100% - 120px); border: none; background: #fff; border-radius: 24px; padding: 24px; font-size: 16px; line-height: 1.8; resize: none; font-family: inherit; }
.btn-magic-full { width: 100%; padding: 18px; border-radius: 16px; border: none; background: #000; color: #fff; font-weight: 700; margin-top: 15px; }

/* 常驻组件 */
.dock { background: var(--card); height: 80px; border-radius: 40px; display: flex; align-items: center; justify-content: space-around; box-shadow: 0 10px 40px rgba(0,0,0,0.06); margin: auto 24px 30px; }
.dock-item { font-size: 22px; cursor: pointer; color: #000; }

.btn-danger { width: 100%; padding: 18px; border-radius: 16px; border: none; background: #FFE5E5; color: #FF3B30; font-weight: 700; margin-top: 20px; }
.modal-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.4); z-index:99999; display:none; align-items:center; justify-content:center; backdrop-filter: blur(15px); }
.modal-box { background: #fff; width: 88%; padding: 30px; border-radius: 32px; box-shadow: 0 25px 70px rgba(0,0,0,0.1); }

.chat-footer { background: #fff; border-top: 0.5px solid rgba(0,0,0,0.05); padding-bottom: var(--safe-bottom); }
.tools-panel { height: 0; overflow: hidden; background: #fafafa; transition: height 0.3s; display: flex; justify-content: space-around; }
.tools-panel.show { height: 110px; padding: 20px; border-top: 0.5px solid #eee; }