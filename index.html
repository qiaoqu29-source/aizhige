<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>AI OS Designer Pro</title>
    <!-- PWA é…ç½® -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- å¼•å…¥æ ·å¼è¡¨ -->
    <link rel="stylesheet" href="style.css">
    <!-- ä¿®å¤ï¼šå¼•å…¥ FontAwesome å›¾æ ‡åº“ï¼Œå¦åˆ™å›¾æ ‡ä¸æ˜¾ç¤º -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="https://img.icons8.com/color/96/brain--v1.png">

<style>
    /* å¼ºåˆ¶ä¿®å¤å›¾æ ‡åç§»é—®é¢˜ */
    .app-icon, 
    .dock .app-icon, 
    .mini-app-grid .app-icon {
        display: grid !important;          /* ä½¿ç”¨ Grid å¸ƒå±€æ›´ç¨³ */
        place-items: center !important;    /* æ°´å¹³å‚ç›´ç»å¯¹å±…ä¸­ */
        place-content: center !important;  /* å†…å®¹å±…ä¸­ */
        text-align: center !important;
        line-height: 1 !important;         /* æ¶ˆé™¤æ–‡å­—è¡Œé«˜åç§» */
    }

    /* ä¿®å¤ FontAwesome å›¾æ ‡æœ¬èº«çš„è¾¹è·å¹²æ‰° */
    .app-icon i,
    .app-icon span {
        margin: 0 !important;
        padding: 0 !important;
        display: block !important;
        line-height: normal !important;
        font-size: inherit; /* ç»§æ‰¿çˆ¶å®¹å™¨å­—ä½“å¤§å° */
    }

    /* é’ˆå¯¹çº¯æ–‡å­—å›¾æ ‡ (API, Aa) çš„å¾®è°ƒ */
    .dock .app-icon {
        font-size: 20px !important; /* æ–‡å­—å›¾æ ‡ç¨å¾®å°ä¸€ç‚¹æ‰å¥½çœ‹ */
        font-weight: 600 !important;
    }
    
    /* é’ˆå¯¹ FontAwesome å›¾æ ‡ (QQ, è®¾ç½®) çš„å¾®è°ƒ */
    .mini-app-grid .app-icon {
        font-size: 28px !important;
    }
</style>
</head>
<body>

<div id="phone-wrapper">
    <!-- çŠ¶æ€æ  -->
    <div class="status-bar">
        <div id="st-time">12:00</div>
        <div style="display:flex; gap:6px; align-items:center;">
            <span>ğŸ“¶</span><span>5G</span>
            <div class="battery"><div class="battery-level"></div></div>
        </div>
    </div>

    <!-- ç³»ç»Ÿé€šçŸ¥å¼¹çª— -->
    <div id="noti-banner" class="noti-banner" onclick="jumpToChat()">
        <div class="noti-icon"><i class="fas fa-comment"></i></div>
        <div style="flex:1;overflow:hidden">
            <div id="noti-n" style="font-weight:700;font-size:15px; margin-bottom:2px">è§’è‰²åå­—</div>
            <div id="noti-t" style="font-size:13px;color:#ccc;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">æ¶ˆæ¯å†…å®¹...</div>
        </div>
    </div>

    <!-- === 1. æ¡Œé¢å›¾å±‚ (æ ¸å¿ƒä¿®æ”¹åŒºåŸŸ) === -->
    <div class="desktop-layer">
    
    <!-- 1. é¡¶éƒ¨ Profile (æ”¹æˆäº†å·¦å¯¹é½çš„å¤§æ ‡é¢˜é£æ ¼) -->
    <div class="profile-card">
        <div class="profile-avatar-wrap">
            <!-- å¤´åƒ -->
            <img src="https://api.dicebear.com/9.x/micah/svg?seed=Moom" alt="Avatar">
        </div>
        <div class="profile-info">
            <!-- è¿™é‡Œçš„æ–‡å­—æ¢æˆäº†çº¯é»‘å¤§æ ‡é¢˜ -->
            <div class="p-name">Hello,<br>User.</div>
            <div class="p-handle">Creative Developer</div>
        </div>
    </div>

    <!-- 2. ä¸­é—´åŒºåŸŸ (å·¦è¾¹æ˜¯å¤§å¡ç‰‡ï¼Œå³è¾¹æ˜¯çº¯å›¾æ ‡) -->
    <div class="dashboard-grid">
        <!-- å·¦ä¾§ï¼šè¯­å½•ç»„ä»¶ -->
        <div class="widget-column">
            <div class="text-widget">
                <div class="t-icon"></div>
                <span>Stay<br>Focused</span>
            </div>
            <div class="text-widget">
                <span>Create<br>Magic</span>
                <div class="t-icon" style="margin-left:auto;background:#ccc!important"></div>
            </div>
        </div>

        <!-- å³ä¾§ï¼šAPPç½‘æ ¼ (å»æ‰äº†æ–‡å­—ï¼Œåªç•™å›¾æ ‡) -->
        <div class="mini-app-grid">
            <!-- èŠå¤© (QQå›¾æ ‡) -->
            <div class="app-item" onclick="openApp('win-chat')">
                <div class="app-icon"><i class="fas fa-comment"></i></div>
            </div>
            <!-- ä¹¦ç± (æš‚æ— åŠŸèƒ½) -->
            <div class="app-item">
                <div class="app-icon"><i class="fas fa-book"></i></div>
            </div>
            <!-- è®¾ç½® (é½¿è½®å›¾æ ‡) -->
            <div class="app-item" onclick="openApp('win-sets')">
                <div class="app-icon"><i class="fas fa-cog"></i></div>
            </div>
            <!-- å†™ä½œ (ç¬”å›¾æ ‡) -->
            <div class="app-item">
                <div class="app-icon"><i class="fas fa-pen-nib"></i></div>
            </div>
        </div>
    </div>

    <!-- 3. åº•éƒ¨ Dock (ç™½è‰²æ‚¬æµ®æ¡) -->
    <div class="dock-container">
        <div class="dock">
            <!-- é‡Œé¢å…¨æ˜¯å›¾æ ‡ï¼Œæ²¡æœ‰æ–‡å­— -->
            <div class="app-item" onclick="openApp('win-sets')">
                <div class="app-icon" style="font-weight:800;font-size:14px">API</div>
            </div>
            <div class="app-item">
                <div class="app-icon" style="font-weight:700">Aa</div>
            </div>
            <div class="app-item">
                <div class="app-icon"><i class="fas fa-phone"></i></div>
            </div>
            <div class="app-item">
                <div class="app-icon"><i class="fab fa-bandcamp"></i></div>
            </div>
        </div>
    </div>
</div>
    <!-- === åº”ç”¨çª—å£ï¼šå¯æ»‘åŠ¨ä¸Šæ¥çš„APP === -->

    <!-- 1. è®¾ç½®çª—å£ -->
    <div class="app-window" id="win-sets">
        <div class="nav-bar">
            <button class="nav-btn" onclick="closeApp('win-sets')">å–æ¶ˆ</button>
            <div class="nav-title">ç³»ç»Ÿè®¾ç½®</div>
            <button class="nav-btn" style="font-weight:700;color:var(--primary-color)" onclick="saveGlobalSets()">å®Œæˆ</button>
        </div>
        <div class="scroll-area">
            <div class="set-group">
                <div class="set-row"><span class="set-label">API åœ°å€</span><input type="text" class="set-val" id="set-url" placeholder="https://..."></div>
                <div class="set-row"><span class="set-label">API Key</span><input type="password" class="set-val" id="set-key" placeholder="sk-..."></div>
                <div class="set-row">
                    <span class="set-label">æ¨¡å‹</span>
                    <div id="model-wrapper" style="width:60%;display:flex;justify-content:flex-end;align-items:center">
                        <input type="text" class="set-val" id="set-model" style="width:70%" placeholder="claude-3-5-sonnet">
                        <span onclick="fetchModelsList()" style="color:var(--ios-blue);font-weight:600;font-size:13px;margin-left:5px;cursor:pointer">æ‹‰å–</span>
                    </div>
                </div>
            </div>
            <div class="set-group">
                <div class="set-row"><span class="set-label">æ¸©åº¦ (Temp)</span><input type="range" id="set-temp" min="0" max="2" step="0.1" style="width:50%"></div>
                <div class="set-row"><span class="set-label">å£çº¸ URL</span><input type="text" class="set-val" id="set-bg" placeholder="å›¾ç‰‡é“¾æ¥"></div>
            </div>
            <button onclick="exportData()" class="btn-action btn-gray"><i class="fas fa-file-export"></i> å¤‡ä»½æ•°æ®åˆ°æœ¬åœ°</button>
            <button onclick="localStorage.clear(); location.reload();" class="btn-action btn-red"><i class="fas fa-trash"></i> æ“¦é™¤æ‰€æœ‰æ•°æ®å¹¶é‡ç½®</button>
        </div>
    </div>

    <!-- 2. ä¼šè¯åˆ—è¡¨çª—å£ -->
    <div class="app-window" id="win-chat">
        <div class="nav-bar">
            <button class="nav-btn" onclick="closeApp('win-chat')">æ¡Œé¢</button>
            <div class="nav-title">æ¶ˆæ¯</div>
            <button class="nav-btn" style="font-size:24px" onclick="openModal('create')"><i class="fas fa-pen-to-square"></i></button>
        </div>
        <div class="scroll-area" id="list-con" style="padding:0">
            <!-- JS ä¼šåœ¨è¿™é‡Œå¡«å……èŠå¤©åˆ—è¡¨ -->
        </div>
    </div>

    <!-- 3. èŠå¤©è¯¦æƒ…é¡µ (æœ€ä¸Šå±‚) -->
    <div class="chat-view" id="win-room">
        <div class="nav-bar">
            <button class="nav-btn" onclick="exitRoom()"><span style="font-size:18px;margin-right:2px"><i class="fas fa-chevron-left"></i></span> è¿”å›</button>
            <div id="room-n" class="nav-title">åå­—</div>
            <button class="nav-btn" onclick="openModal('edit')" style="font-size:18px"><i class="fas fa-ellipsis"></i></button>
        </div>
        <div class="im-scroll" id="im-scroll">
            <div class="im-inject" id="im-inject"></div>
        </div>
        <div class="im-footer">
            <div class="im-input-bar">
                <div class="im-btn-icon"><i class="fas fa-microphone"></i></div>
                <div class="im-input-wrap">
                    <input type="text" id="chat-inp" class="im-input" onkeypress="if(event.key==='Enter')handleSend()">
                </div>
                <div class="im-btn-icon"><i class="far fa-smile"></i></div>
                <div class="im-btn-icon" style="font-size:26px" onclick="toggleT()"><i class="fas fa-plus-circle"></i></div>
            </div>
            <div class="tools-panel" id="t-panel">
                <div class="tool-box" onclick="up('img')"><div class="tool-icon-bg">ğŸ–¼ï¸</div><span>ç›¸å†Œ</span></div>
                <div class="tool-box" onclick="up('file')"><div class="tool-icon-bg">ğŸ“„</div><span>æ–‡ä»¶</span></div>
                <div class="tool-box" onclick="clearH()"><div class="tool-icon-bg">ğŸ—‘ï¸</div><span>æ¸…ç©ºå¯¹è¯</span></div>
            </div>
        </div>
    </div>

    <!-- === æ¨¡æ€æ¡†ç»„ä»¶ === -->

    <!-- è§’è‰²é…ç½®æ¨¡æ€æ¡† -->
    <div class="modal-overlay" id="mo-overlay">
        <div class="modal-box">
            <h3 id="mo-title" style="text-align:center;margin-bottom:20px;font-size:17px">è§’è‰²é…ç½®</h3>
            
            <span class="modal-label">åå­—</span>
            <input type="text" id="mo-n" class="modal-input" placeholder="Name">
            
            <span class="modal-label">æ ¸å¿ƒäººè®¾ (Prompt)</span>
            <textarea id="mo-p" class="modal-input" style="height:80px;resize:none" placeholder="ä½ æ˜¯..."></textarea>
            
            <div style="position:relative">
                <span class="modal-label">é•¿æœŸè®°å¿† (Memory)</span>
                <button class="btn-ai-magic" onclick="summarizeMemory()">ğŸ§  æ™ºèƒ½æç‚¼</button>
                <textarea id="mo-mem" class="modal-input" style="height:100px;resize:none;color:#aaffaa" placeholder="è¿™é‡Œå­˜æ”¾é‡è¦çš„å›å¿†..."></textarea>
            </div>

            <div style="background:rgba(255,255,255,0.05);padding:12px;border-radius:12px;margin-bottom:20px">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px">
                    <span style="font-size:14px;color:#ccc">ä¸»åŠ¨å‘æ¶ˆæ¯</span>
                    <input type="checkbox" id="mo-active" style="width:20px;height:20px">
                </div>
                <div style="display:flex;align-items:center;gap:10px">
                    <span style="font-size:12px;color:#888">é—´éš”(åˆ†é’Ÿ):</span>
                    <input type="number" id="mo-interval" style="width:60px;background:#333;color:#fff;border:none;padding:5px;border-radius:6px" value="60">
                </div>
            </div>

            <div style="display:flex;gap:12px">
                <button onclick="hideModal()" class="modal-btn" style="background:#3a3a3c;color:#fff">å–æ¶ˆ</button>
                <button onclick="commitModal()" class="modal-btn" style="background:var(--primary-color);color:#fff">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <!-- æ¶ˆæ¯ç¼–è¾‘æ¨¡æ€æ¡† -->
    <div class="modal-overlay" id="edit-msg-overlay">
        <div class="modal-box">
            <h3 style="text-align:center;margin-bottom:15px;font-size:16px">ä¿®æ”¹å¯¹è¯å†…å®¹</h3>
            <textarea id="edit-msg-val" class="modal-input" style="height:150px;resize:none"></textarea>
            <div style="display:flex;gap:12px">
                <button onclick="document.getElementById('edit-msg-overlay').style.display='none'" class="modal-btn" style="background:#3a3a3c;color:#fff">å–æ¶ˆ</button>
                <button id="save-msg-btn" class="modal-btn" style="background:var(--ios-blue);color:#fff">ä¿®æ­£è®°å¿†</button>
            </div>
        </div>
    </div>

    <!-- éšè—çš„åŠŸèƒ½è¾“å…¥ -->
    <input type="file" id="up-i" accept="image/*" style="display:none" onchange="dImg(this)">
    <input type="file" id="up-f" accept=".txt,.md" style="display:none" onchange="dFile(this)">
    <canvas id="comp-c" style="display:none"></canvas>

    <!-- å¼•å…¥ JS -->
    <script src="script.js"></script>
</div>
</body>
</html>